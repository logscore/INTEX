<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Make a Donation</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">
	<style>
		:root {
			--cream: #f9f5ea;
			--light-pink: #ffd8d1;
			--pink: #f9afb1;
			--gray: #3a3f3b;
		}

		body {
			background-color: var(--light-pink);
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 0;
			color: var(--gray);
			min-height: 100vh;
			display: flex;
			flex-direction: column;
		}

		.navbar-brand {
			font-weight: bold;
			display: flex;
			align-items: center;
			gap: 6px;
			font-size: 1.25rem;
		}

		.btn-white {
			background: white;
			border: 2px solid var(--gray);
			color: var(--gray) !important;
			transition: 0.2s;
		}

		.btn-white:hover {
			background: var(--gray);
			color: white !important;
		}

		.page-wrapper {
			padding: 40px 20px;
			flex: 1;
		}

		.card {
			border-radius: 12px;
			box-shadow: 0px 0px 10px rgba(0,0,0,0.05);
		}

		.page-title {
			font-family: 'DM Serif Display', serif;
			font-size: 2rem;
			text-align: center;
			margin-bottom: 30px;
			color: var(--gray);
		}

		.form-section {
			max-width: 600px;
			margin: 0 auto;
		}

		.footer {
			background-color: black;
			color: white;
			height: 100px;
			display: flex;
			justify-content: center;
			align-items: center;
			margin-top: auto;
		}

		.footer-text {
			font-family: 'DM Serif Display', serif;
			font-size: 1.5rem;
			display: flex;
			gap: 10px;
			align-items: center;
		}

		.copyright {
			text-align: center;
			padding: 8px 0 20px;
			font-size: 0.9rem;
		}
	</style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-light bg-white shadow-sm px-4">
	<a class="navbar-brand" href="/">
		Ella
		<img src="/fulllogo.jpg" alt="Ella Rises Logo" style="width:35px; height:35px; object-fit: contain; vertical-align: text-bottom; margin-left: 8px;">
		Rises
	</a>

	<div>
		<a href="/" class="btn btn-white btn-sm me-2">Back to Home</a>
		<% if (typeof userLevel !== 'undefined' && userLevel === 'M') { %>
			<a href="/displayDonations" class="btn btn-white btn-sm">Manage Donations</a>
		<% } %>
	</div>
</nav>

<!-- PAGE CONTENT -->
<div class="page-wrapper container">
	<div class="form-section">
		<h1 class="page-title">Make a Donation</h1>

		<div class="card p-4">
			<p class="text-center mb-4">
				Your generous donation helps support our mission to provide educational opportunities for young women.
			</p>

			<% if (typeof success_message !== 'undefined' && success_message) { %>
				<div class="alert alert-success" role="alert">
					<strong>Thank you!</strong> <%= success_message %>
				</div>
			<% } %>

			<% if (typeof error_message !== 'undefined' && error_message) { %>
				<div class="alert alert-danger" role="alert">
					<strong>Error:</strong> <%= error_message %>
				</div>
			<% } %>

			<% if (typeof isNewPerson !== 'undefined' && isNewPerson) { %>
				<!-- New Person Prompt Modal -->
				<div class="alert alert-info" role="alert">
					<h5 class="mb-3">Welcome, <%= donorName %>!</h5>
					<p class="mb-3">We don't have you registered in our system yet. To fully track your contributions and share updates about Ella Rises programs, we'd love to add your information to our participant database.</p>
					
					<div class="d-flex gap-2">
						<button class="btn btn-primary" onclick="registerParticipant('<%= donorName %>', '<%= donorEmail %>', '<%= donationAmount %>')">
							Register Now
						</button>
						<button class="btn btn-secondary" onclick="window.location.href='https://givebutter.com/EllaRises'">
							Continue with Donation Only
						</button>
					</div>
				</div>

				<!-- Hidden form for continuing donation -->
				<form id="continueDonationForm" method="POST" action="/completeDonation" style="display: none;">
					<input type="hidden" name="name" value="<%= donorName %>">
					<input type="hidden" name="email" value="<%= donorEmail %>">
					<input type="hidden" name="amount" value="<%= donationAmount %>">
				</form>
			<% } else { %>

			<form method="POST" action="/submitDonation">
				<div class="mb-3">
					<label for="donorName" class="form-label">Full Name *</label>
					<input type="text" class="form-control" id="donorName" name="donorName" required placeholder="John Doe">
					<small class="text-muted">We'll use this name for our records and acknowledgments.</small>
				</div>

				<div class="mb-3">
					<label for="donorEmail" class="form-label">Email Address *</label>
					<input type="email" class="form-control" id="donorEmail" name="donorEmail" required placeholder="john@example.com">
					<small class="text-muted">We'll use this to keep you updated about Ella Rises.</small>
				</div>

				<div class="mb-4">
					<label for="donationAmount" class="form-label">Donation Amount ($) *</label>
					<div class="input-group">
						<span class="input-group-text">$</span>
						<input type="number" class="form-control" id="donationAmount" name="donationAmount" required placeholder="0.00" step="0.01" min="0.01">
					</div>
					<small class="text-muted">Please enter the amount you wish to donate.</small>
				</div>

				<div class="d-grid gap-2 mb-3">
					<button type="submit" class="btn btn-primary btn-lg">Complete Donation</button>
				</div>

				<p class="text-center text-muted small">
					<strong>Note:</strong> This form records your donation information in our system. 
					For online payment processing, you will be redirected to our secure payment provider.
				</p>
			</form>
			<% } %>

			<hr>

			<div class="text-center">
				<p class="mb-2">Prefer to donate online?</p>
				<a href="https://givebutter.com/EllaRises" target="_blank" class="btn btn-outline-primary">
					Donate via GiveButter
				</a>
			</div>
		</div>
	</div>
</div>

<!-- FOOTER -->
<div class="footer">
	<div class="footer-text">
		Ella
		<img src="/fulllogo.jpg" alt="Ella Rises Logo" style="width:40px; height:40px; object-fit: contain;">
		Rises
	</div>
</div>

<p class="copyright">&copy; 2025 Ella Rises. All rights reserved.</p>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
	function registerParticipant(name, email, amount) {
		// Redirect to participant registration page with pre-filled info
		const params = new URLSearchParams();
		params.append('name', name);
		params.append('email', email);
		params.append('amount', amount);
		params.append('fromDonation', 'true');
		window.location.href = `/registerParticipant?${params.toString()}`;
	}
</script>

</body>
</html>
