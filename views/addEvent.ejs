<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Add Event - Ella Rises</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">
	<style>
		:root {
			--cream: #f9f5ea;
			--light-pink: #ffd8d1;
			--pink: #f9afb1;
			--gray: #3a3f3b;
		}

		body { 
			background-color: var(--light-pink); 
			font-family: Arial, sans-serif; 
			margin: 0; 
			color: var(--gray); 
			min-height: 100vh; 
			display: flex; 
			flex-direction: column; 
		}

		.navbar-brand { 
			font-weight: bold; 
			display: flex; 
			align-items: center; 
			gap: 6px; 
			font-size: 1.25rem; 
		}

		.btn-white { 
			background: white; 
			border: 2px solid var(--gray); 
			color: var(--gray) !important; 
			transition: 0.2s; 
		}

		.btn-white:hover { 
			background: var(--gray); 
			color: white !important; 
		}

		.page-wrapper { 
			padding: 40px 20px; 
			flex: 1; 
		}

		.card { 
			border-radius: 12px; 
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
		}

		.form-group {
			margin-bottom: 20px;
		}

		.form-group label {
			font-weight: 600;
			color: var(--gray);
			margin-bottom: 8px;
			display: block;
		}

		.form-group input,
		.form-group select,
		.form-group textarea {
			border: 2px solid #ddd;
			border-radius: 6px;
			padding: 10px;
			font-size: 14px;
			width: 100%;
		}

		.form-group input:focus,
		.form-group select:focus,
		.form-group textarea:focus {
			outline: none;
			border-color: #e45858;
			box-shadow: 0 0 0 0.2rem rgba(228, 88, 88, 0.25);
		}

		.form-group textarea {
			resize: vertical;
			min-height: 100px;
		}

		.form-actions {
			display: flex;
			gap: 10px;
			justify-content: flex-end;
			margin-top: 30px;
		}

		.btn-submit {
			background-color: #28a745;
			border: none;
			color: white;
			padding: 10px 20px;
			border-radius: 6px;
			font-weight: 600;
			cursor: pointer;
			transition: 0.2s;
		}

		.btn-submit:hover {
			background-color: #218838;
		}

		.btn-cancel {
			background-color: #e0e0e0;
			border: none;
			color: var(--gray);
			padding: 10px 20px;
			border-radius: 6px;
			font-weight: 600;
			cursor: pointer;
			transition: 0.2s;
			text-decoration: none;
		}

		.btn-cancel:hover {
			background-color: #d0d0d0;
		}

		.footer { 
			background-color: black; 
			color: white; 
			height: 100px; 
			display: flex; 
			justify-content: center; 
			align-items: center; 
			margin-top: auto; 
			width: 100vw; 
			position: relative; 
			left: 50%; 
			right: 50%; 
			margin-left: -50vw; 
			margin-right: -50vw; 
		}

		.footer-text { 
			font-family: 'DM Serif Display', serif; 
			font-size: 1.5rem; 
			display: flex; 
			gap: 10px; 
			align-items: center; 
		}

		.copyright { 
			text-align: center; 
			padding: 8px 0 20px; 
			font-size: 0.9rem; 
		}
	</style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-light bg-white shadow-sm px-4">
	<a class="navbar-brand" href="/">
		Ella
		<img src="/fulllogo.jpg" alt="Ella Rises Logo" style="width:35px; height:35px; object-fit: contain; vertical-align: text-bottom; margin-left: 8px;">
		Rises
	</a>

	<div>
		<a href="/displayEvents" class="btn btn-white btn-sm">Back to Events</a>
	</div>
</nav>

<!-- PAGE -->
<div class="page-wrapper container">
	<div class="row justify-content-center">
		<div class="col-md-8">
			<div class="card p-4">
				<h2>Add New Event</h2>

				<form id="addEventForm">
					<div class="form-group">
						<label for="eventName">Event Name</label>
						<input type="text" id="eventName" name="eventName" required>
					</div>

					<div class="form-group">
						<label for="eventLocation">Location</label>
						<input type="text" id="eventLocation" name="eventLocation" required>
					</div>

					<div class="form-group">
						<label for="eventTemplateID">Event Type</label>
						<select id="eventTemplateID" name="eventTemplateID" required>
							<option value="">Select an event type...</option>
							<% if (typeof eventTemplates !== 'undefined' && eventTemplates.length > 0) { %>
								<% eventTemplates.forEach(template => { %>
									<option value="<%= template.eventtemplateid || template.EventTemplateID %>">
										<%= template.eventtype || template.EventType %>
									</option>
								<% }); %>
							<% } %>
						</select>
					</div>

					<div class="form-group">
						<label for="eventDateTimeStart">Start Date & Time</label>
						<input type="datetime-local" id="eventDateTimeStart" name="eventDateTimeStart" required>
					</div>

					<div class="form-group">
						<label for="eventDateTimeEnd">End Date & Time</label>
						<input type="datetime-local" id="eventDateTimeEnd" name="eventDateTimeEnd" required>
					</div>

					<div class="form-group">
						<label for="eventCapacity">Capacity</label>
						<input type="number" id="eventCapacity" name="eventCapacity" min="1" required>
					</div>

					<div class="form-group">
						<label for="eventRegistrationDeadline">Registration Deadline</label>
						<input type="date" id="eventRegistrationDeadline" name="eventRegistrationDeadline" required>
					</div>

					<div class="form-actions">
						<a href="/displayEvents" class="btn-cancel">Cancel</a>
						<button type="submit" class="btn-submit">Add Event</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

<!-- FOOTER -->
<div class="footer">
	<div class="footer-text">
		Ella
		<img src="/fulllogo.jpg" alt="Ella Rises Logo" style="width:40px; height:40px; object-fit: contain;">
		Rises
	</div>
</div>

<p class="copyright">&copy; 2025 Ella Rises. All rights reserved.</p>

<script>
	document.getElementById('addEventForm').addEventListener('submit', async (e) => {
		e.preventDefault();

		const formData = {
			eventName: document.getElementById('eventName').value,
			eventLocation: document.getElementById('eventLocation').value,
			eventDateTimeStart: document.getElementById('eventDateTimeStart').value,
			eventDateTimeEnd: document.getElementById('eventDateTimeEnd').value,
			eventCapacity: document.getElementById('eventCapacity').value,
			eventRegistrationDeadline: document.getElementById('eventRegistrationDeadline').value,
			eventTemplateID: document.getElementById('eventTemplateID').value
		};

		try {
			const response = await fetch('/submitEvent', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(formData)
			});

			const data = await response.json();

			if (data.success) {
				alert('Event added successfully!');
				window.location.href = '/displayEvents';
			} else {
				alert('Error adding event: ' + (data.message || 'Unknown error'));
			}
		} catch (err) {
			console.error('Error:', err);
			alert('Error adding event');
		}
	});
</script>

</body>
</html>
