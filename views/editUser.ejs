<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title><%= (typeof isNew !== 'undefined' && isNew) ? 'Add User' : 'Edit User' %></title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">
        <style>
            :root {
                --cream: #f9f5ea;
                --light-pink: #ffd8d1;
                --pink: #f9afb1;
                --gray: #3a3f3b;
            }

            body {
                background-color: var(--light-pink);
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
                color: var(--gray);
                min-height: 100vh;
                display: flex;
                flex-direction: column;
            }

            .navbar-brand {
                font-weight: bold;
                display: flex;
                align-items: center;
                gap: 6px;
                font-size: 1.25rem;
            }

            .page-wrapper {
                padding: 40px 20px;
                flex: 1;
            }

            .card {
                border-radius: 12px;
                box-shadow: 0px 0px 10px rgba(0,0,0,0.05);
            }

            .btn-white {
                background: white;
                border: 2px solid var(--gray);
                color: var(--gray) !important;
                transition: 0.2s;
            }

            .btn-white:hover {
                background: var(--gray);
                color: white !important;
            }
        </style>
    </head>
    <body>
        <!-- NAVBAR -->
        <nav class="navbar navbar-light bg-white shadow-sm px-4">
            <a class="navbar-brand" href="/">
                Ella
                <img src="/fulllogo.jpg" alt="Ella Rises Logo" style="width:35px; height:35px; object-fit: contain; vertical-align: text-bottom; margin-left: 8px;">
                Rises
            </a>
            <div>
                <a href="/displayUsers" class="btn btn-white btn-sm me-2">Back to Users</a>
                <a href="/userDashboard" class="btn btn-white btn-sm me-2">Dashboard</a>
                <a href="/logout" class="btn btn-white btn-sm">Logout</a>
            </div>
        </nav>

        <!-- PAGE -->
        <div class="page-wrapper container">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="card p-4">
                        <h2><%= (typeof isNew !== 'undefined' && isNew) ? 'Add New User' : 'Edit User' %></h2>

                        <% if (typeof error_message !== 'undefined' && error_message) { %>
                            <div class="alert alert-danger" role="alert">
                                <%= error_message %>
                            </div>
                        <% } %>

                        <form action="/editUser/<%= (typeof user !== 'undefined' && user.id) ? user.id : 'null' %>" method="post">
                            <div class="mb-3">
                                <label for="email" class="form-label">Email *</label>
                                <input type="email" id="email" name="email" value="<%= (typeof user !== 'undefined' && user.email) ? user.email : '' %>" class="form-control" required>
                            </div>

                            <div class="mb-3">
                                <label for="password" class="form-label">Password *</label>
                                <input type="text" id="password" name="password" value="<%= (typeof user !== 'undefined' && user.password) ? user.password : '' %>" class="form-control" required>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Level *</label><br>
                                <div class="form-check form-check-inline">
                                    <input type="radio" id="levelM" name="level" value="M" <%= (typeof user !== 'undefined' && user.level === 'M') ? 'checked' : '' %> class="form-check-input" required>
                                    <label class="form-check-label" for="levelM">Manager (M)</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input type="radio" id="levelU" name="level" value="U" <%= (typeof user !== 'undefined' && user.level === 'U') ? 'checked' : '' %> class="form-check-input" required>
                                    <label class="form-check-label" for="levelU">User (U)</label>
                                </div>
                            </div>

                            <div class="mt-4">
                                <button type="submit" class="btn btn-success me-2">
                                    <%= (typeof isNew !== 'undefined' && isNew) ? 'Create User' : 'Update User' %>
                                </button>
                                <a href="/displayUsers" class="btn btn-secondary">Cancel</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>