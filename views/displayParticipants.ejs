<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Participants</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #ffd8d1; font-family: Arial, sans-serif; padding-top: 90px; }
    .card { border-radius: 12px; }
    .label { font-weight: 600; color: #444; }
  </style>
</head>
<body>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="card p-4 mb-4">
          <h2>Participants</h2>
          <p class="text-muted">View participant information. Admins can view all participants with <code>?all=true</code>.</p>
        </div>

        <% if (typeof participants !== 'undefined' && participants && participants.length > 0) { %>
          <div class="card p-3 mb-4">
            <h4>All Participants</h4>
            <div class="table-responsive">
              <table class="table table-sm">
                <thead class="table-dark">
                  <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>DOB</th>
                    <th>Role</th>
                    <th>Phone</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Zip</th>
                    <th>School/Employer</th>
                    <th>Field</th>
                    <th>Donations</th>
                  </tr>
                </thead>
                <tbody>
                  <% participants.forEach(function(p) { %>
                    <tr>
                      <td><a href="/displayParticipants?id=<%= p.ParticipantID %>"><%= p.ParticipantFirstName %> <%= p.ParticipantLastName %></a></td>
                      <td><%= p.ParticipantEmail %></td>
                      <td><%= p.ParticipantDOB ? new Date(p.ParticipantDOB).toLocaleDateString() : '—' %></td>
                      <td><%= p.ParticipantRole || '—' %></td>
                      <td><%= p.ParticipantPhone || '—' %></td>
                      <td><%= p.ParticipantCity || '—' %></td>
                      <td><%= p.ParticipantState || '—' %></td>
                      <td><%= p.ParticipantZip || '—' %></td>
                      <td><%= p.ParticipantSchoolOrEmployer || '—' %></td>
                      <td><%= p.ParticipantFieldOfInterest || '—' %></td>
                      <td>$<%= p.TotalDonations !== null ? p.TotalDonations : '0.00' %></td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>
            </div>
          </div>
        <% } else if (typeof participant !== 'undefined' && participant && participant.ParticipantID) { %>
          <div class="card p-4 mb-4">
            <h4><%= participant.ParticipantFirstName %> <%= participant.ParticipantLastName %> <small class="text-muted">(ID: <%= participant.ParticipantID %>)</small></h4>
            <div class="row mt-3">
              <div class="col-md-6">
                <p><span class="label">Email:</span> <%= participant.ParticipantEmail %></p>
                <p><span class="label">Phone:</span> <%= participant.ParticipantPhone || '—' %></p>
                <p><span class="label">DOB:</span> <%= participant.ParticipantDOB ? new Date(participant.ParticipantDOB).toLocaleDateString() : '—' %></p>
                <p><span class="label">Role:</span> <%= participant.ParticipantRole || '—' %></p>
              </div>
              <div class="col-md-6">
                <p><span class="label">City:</span> <%= participant.ParticipantCity || '—' %></p>
                <p><span class="label">State:</span> <%= participant.ParticipantState || '—' %></p>
                <p><span class="label">Zip:</span> <%= participant.ParticipantZip || '—' %></p>
              </div>
            </div>

            <hr />
            <p><span class="label">School / Employer:</span> <%= participant.ParticipantSchoolOrEmployer || '—' %></p>
            <p><span class="label">Field of Interest:</span> <%= participant.ParticipantFieldOfInterest || '—' %></p>
            <p><span class="label">Total Donations:</span> $<%= participant.TotalDonations !== null ? participant.TotalDonations : '0.00' %></p>
          </div>
        <% } else { %>
          <div class="alert alert-info">No participant information found for your account.</div>
        <% } %>

      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
